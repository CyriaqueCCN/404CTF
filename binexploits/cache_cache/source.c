int rand_lim(int param_1)

{
  int iVar1;
  
  do {
    iVar1 = rand();
    iVar1 = iVar1 / (int)(0x7fffffff / (long)(param_1 + 1));
  } while (param_1 < iVar1);
  return iVar1;
}

char picker(char *param_1)

{
  int iVar1;
  size_t sVar2;
  
  sVar2 = strlen(param_1);
  iVar1 = rand_lim((int)sVar2 + -1);
  return param_1[iVar1];
}

int         main(void)

{
  int iVar1;
  time_t tVar2;
  size_t sVar3;
  long in_FS_OFFSET;
  char local_132;
  undefined local_131;
  int local_130;
  uint local_12c;
  undefined8 local_128;
  FILE *local_120;
  char *local_118 [4];
  char local_f8 [32];
  char local_d8 [32];
  char local_b8 [48];
  char local_88 [120];
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  setvbuf((FILE *)stdout,(char *)0x0,2,0);
  local_130 = 0x14;
  local_132 = 'a';
  local_118[0] = "1234567890";
  local_118[1] = "abcdefghijklmnoqprstuvwyzx";
  local_118[2] = "ABCDEFGHIJKLMNOPQRSTUYWVZX";
  local_118[3] = "!@#$%^&*(){}[]:<>?,./";
  local_128 = 4;
  tVar2 = time((time_t *)0x0);
  srandom((uint)tVar2);
  for (; local_130 != 0; local_130 = local_130 + -1) {
    local_12c = rand_lim((int)local_128 + -1);
    local_132 = picker(local_118[local_12c]);
    strncat(local_f8,&local_132,1);
  }
  puts("Veuillez decliner identite");
  fgets(local_88,0x78,(FILE *)stdin);
  printf("Bonjour ");
  printf(local_88);
  puts("\nQuel est votre mot de passe?");
  fgets(local_d8,0x15,(FILE *)stdin);
  sVar3 = strcspn(local_d8,"\n");
  local_d8[sVar3] = '\0';
  puts("Verif mdp en cours...");
  iVar1 = strcmp(local_f8,local_d8);
  local_131 = iVar1 == 0;
  if ((bool)local_131) {
    puts(
        "Bonjour Monsieur Dupont. \nComme toujours, nous sommes heureux de faire affaire avec vous."
        );
    puts("Adresse ethereum : ");
    local_120 = fopen64("flag.txt","rt");
    fgets(local_b8,0x28,local_120);
    puts(local_b8);
    fclose(local_120);
  }
  else {
    puts("Connexion non desiree, changement de l'endpoint...");
  }
  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return 0;
}

